name: Run Validation

on:
  workflow_call:
    inputs:
      validation-type:
        required: true
        type: string
        description: The type of validation to run (e.g., source-maps-mv2, mozilla-lint-mv2)
      build-command:
        required: true
        type: string
        description: The build command to run
      validation-command:
        required: true
        type: string
        description: The command to run for validation

jobs:
  run-validation:
    name: Run ${{ inputs.validation-type }} validation
    runs-on: ubuntu-latest
    container:
      image: cimg/node:22.13-browsers
    steps:
      - name: Install dependencies
        run: |
          sudo apt-get update && sudo apt-get install zstd
          sudo corepack enable

      - name: Checkout and setup environment
        uses: metamask/github-tools/.github/actions/checkout-and-setup@1299bb1de0c6974ae6d0a32c7e8897fe168239ac
        with:
          is-high-risk-environment: false

      - name: Build
        run: ${{ inputs.build-command }}

      - name: Run validation
        run: ${{ inputs.validation-command }}
