# On every push to a release branch (Version-v* or release/*), this workflow rebuilds the matching
# changelog branch, re-runs the auto-changelog script, and either updates or recreates the changelog PR.
name: Update Release Changelog PR

on:
  push:
    branches:
      - 'Version-v*'
      - 'release/[0-9]+.[0-9]+.[0-9]+'

concurrency:
  group: update-release-changelog-${{ github.ref }}
  cancel-in-progress: false

jobs:
  refresh-changelog:
    permissions:
      contents: write
      pull-requests: write
    uses: MetaMask/github-tools/.github/workflows/update-release-changelog.yml@INFRA-2576-UpdateChangelogAutomatically
    with:
      release-branch: ${{ github.ref_name }}
      repository-url: ${{ github.server_url }}/${{ github.repository }}
      platform: extension
      github-tools-version: INFRA-2576-UpdateChangelogAutomatically
      previous-version-ref: null
    secrets:
      github-token: ${{ secrets.PR_TOKEN }}
